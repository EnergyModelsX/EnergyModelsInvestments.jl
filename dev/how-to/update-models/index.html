<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Update models · EnergyModelsInvestments</title><meta name="title" content="Update models · EnergyModelsInvestments"/><meta property="og:title" content="Update models · EnergyModelsInvestments"/><meta property="twitter:title" content="Update models · EnergyModelsInvestments"/><meta name="description" content="Documentation for EnergyModelsInvestments."/><meta property="og:description" content="Documentation for EnergyModelsInvestments."/><meta property="twitter:description" content="Documentation for EnergyModelsInvestments."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">EnergyModelsInvestments</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/quick-start/">Quick Start</a></li><li><a class="tocitem" href="../../manual/philosophy/">Philosophy</a></li><li><a class="tocitem" href="../../manual/optimization-variables/">Optimization variables</a></li><li><a class="tocitem" href="../../manual/simple-example/">Example</a></li><li><a class="tocitem" href="../../manual/NEWS/">Release notes</a></li></ul></li><li><span class="tocitem">How to</span><ul><li class="is-active"><a class="tocitem" href>Update models</a><ul class="internal"><li><a class="tocitem" href="#how_to-update-05"><span>Adjustments from 0.5.x</span></a></li></ul></li><li><a class="tocitem" href="../use-emi/">Use EMI</a></li><li><a class="tocitem" href="../contribute/">Contribute to EnergyModelsInvestments</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../library/public/">Public</a></li><li><a class="tocitem" href="../../library/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How to</a></li><li class="is-active"><a href>Update models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Update models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EnergyModelsX/EnergyModelsInvestments.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EnergyModelsX/EnergyModelsInvestments.jl/blob/main/docs/src/how-to/update-models.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="how_to-update"><a class="docs-heading-anchor" href="#how_to-update">Update your model to the latest versions</a><a id="how_to-update-1"></a><a class="docs-heading-anchor-permalink" href="#how_to-update" title="Permalink"></a></h1><p><code>EnergyModelsInvestments</code> is still in a pre-release version. Hence, there are frequently breaking changes occuring, although we plan to keep backwards compatibility. This document is designed to provide users with information regarding how they have to adjust their models to keep compatibility to the latest changes. We will as well implement information regarding the adjustment of extension packages, although this is more difficult due to the vast majority of potential changes.</p><h2 id="how_to-update-05"><a class="docs-heading-anchor" href="#how_to-update-05">Adjustments from 0.5.x</a><a id="how_to-update-05-1"></a><a class="docs-heading-anchor-permalink" href="#how_to-update-05" title="Permalink"></a></h2><p>The following changes obly affect older models using <code>EnergyModelsBase</code> and <code>EnergyModelsGeography</code>. They are not relevant if you do not use <code>EnergyModelsBase</code>.</p><h3 id="how_to-update-05-key"><a class="docs-heading-anchor" href="#how_to-update-05-key">Key changes for investment type descriptions</a><a id="how_to-update-05-key-1"></a><a class="docs-heading-anchor-permalink" href="#how_to-update-05-key" title="Permalink"></a></h3><p>Version 0.7 in <code>EnergyModelsBase</code> introduced the potential to have charge and discharge capacities through <em>storage parameters</em>. This required hence a rework of how we model investments into storage nodes. We decided to use this requirement as an approach for a full rework of the investment options, increasing the potential to make <code>EnergyModelsInvestments</code> independent of <code>EnergyModelsBase</code>.</p><p>The key changes are:</p><ul><li>All parameters for investment or lifetime modes are incorporated in the respective investment or lifetime mode.</li><li>The previously used investment data, <code>InvData</code>, <code>InvDataStorage</code>, and <code>TransInvData</code>, are replaced by <code>SingleInvData</code> (for standard node and transmission mode investments) and <code>StorageInvData</code> (for storage investments).</li><li>CAPEX cariables are renamed:<ul><li><code>:capex_cap</code> is now <code>:cap_capex</code>,</li><li><code>:capex_rate</code> is now given by <code>:stor_charge_capex</code> and <code>:stor_discharge_capex</code>,</li><li><code>:capex_stor</code> is now given by <code>:stor_level_capex</code>, and</li><li><code>:capex_trans</code> is now given by <code>:trans_cap_capex</code>.</li></ul></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The legacy constructors for calls of the composite type of version 0.5 will be included at least until version 0.7. They are located <a href="https://github.com/EnergyModelsX/EnergyModelsBase.jl/blob/main/ext/EMIExt/structures/legacy_constructor.jl">within the extension</a> from version 0.7 onwards.</p></div></div><h3 id="how_to-update-05-inv_data"><a class="docs-heading-anchor" href="#how_to-update-05-inv_data"><code>InvData</code> and <code>TransInvData</code></a><a id="how_to-update-05-inv_data-1"></a><a class="docs-heading-anchor-permalink" href="#how_to-update-05-inv_data" title="Permalink"></a></h3><p>The following changes are written down for <code>InvData</code>, but are equivalent for <code>TransInvData</code>. The previous description for nodal investments was given by:</p><pre><code class="language-julia hljs">@kwdef struct InvData &lt;: InvestmentData
    capex_cap::TimeProfile
    cap_max_inst::TimeProfile
    cap_max_add::TimeProfile
    cap_min_add::TimeProfile
    inv_mode::Investment = ContinuousInvestment()
    cap_start::Union{Real, Nothing} = nothing
    cap_increment::TimeProfile = FixedProfile(0)
    life_mode::LifetimeMode = UnlimitedLife()
    lifetime::TimeProfile = FixedProfile(0)
end</code></pre><p>while the new type for single investments is given as</p><pre><code class="language-julia hljs">struct SingleInvData &lt;: InvestmentData
    cap::AbstractInvData
end</code></pre><p>with a constructor allowing directly the creation without having to specify the intermediate type.</p><p>The new type, <a href="../../library/public/#EnergyModelsInvestments.AbstractInvData"><code>AbstractInvData</code></a> has at the time being two subtypes, <a href="../../library/public/#EnergyModelsInvestments.NoStartInvData"><code>NoStartInvData</code></a> and <a href="../../library/public/#EnergyModelsInvestments.StartInvData"><code>StartInvData</code></a>, given as:</p><pre><code class="language-julia hljs">@kwdef struct NoStartInvData &lt;: AbstractInvData
    capex::TimeProfile       # Capex to install cap
    max_inst::TimeProfile    # Max installable capacity in one period (in total)
    inv_mode::Investment
    life_mode::LifetimeMode
end

@kwdef struct StartInvData &lt;: AbstractInvData
    capex::TimeProfile      # Capex to install cap
    max_inst::TimeProfile   # Max installable capacity in one period (in total)
    initial::Real           # Initially installed capacity
    inv_mode::Investment
    life_mode::LifetimeMode
end</code></pre><p>Hence, the original <code>InvData</code> type would be translated as</p><pre><code class="language-julia hljs"># If no starting capacity was provided
SingleInvData(
    capex_cap,
    cap_max_inst,
    tmp_inv_mode,
    tmp_life_mode,
)

# If a starting capacity was provided
SingleInvData(
    capex_cap,
    cap_max_inst,
    cap_start,
    tmp_inv_mode,
    tmp_life_mode,
)
</code></pre><p>The translation of the parameters <code>cap_max_add</code>, <code>cap_min_add</code>, and <code>cap_increment</code> is dependent on the chosen investment mode, see below. This makes the legacy constructor slightly more complex as it is necessary to check for the individual type.</p><h3 id="InvDataStorage"><a class="docs-heading-anchor" href="#InvDataStorage"><code>InvDataStorage</code></a><a id="InvDataStorage-1"></a><a class="docs-heading-anchor-permalink" href="#InvDataStorage" title="Permalink"></a></h3><p><code>InvDataStorage</code> was significantly reworked since version 0.5. The total rework is provided below.</p><p>The previous description for storage investments was given by:</p><pre><code class="language-julia hljs">@kwdef struct InvDataStorage &lt;: InvestmentData
    capex_rate::TimeProfile
    rate_max_inst::TimeProfile
    rate_max_add::TimeProfile
    rate_min_add::TimeProfile
    capex_stor::TimeProfile
    stor_max_inst::TimeProfile
    stor_max_add::TimeProfile
    stor_min_add::TimeProfile
    inv_mode::Investment = ContinuousInvestment()
    rate_start::Union{Real, Nothing} = nothing
    stor_start::Union{Real, Nothing} = nothing
    rate_increment::TimeProfile = FixedProfile(0)
    stor_increment::TimeProfile = FixedProfile(0)
    life_mode::LifetimeMode = UnlimitedLife()
    lifetime::TimeProfile = FixedProfile(0)
end</code></pre><p>The new storage investment type is now layered, allowing for different options for the individual capacities given through the fields <code>charge</code>, <code>level</code>, and <code>discharge</code>:</p><pre><code class="language-julia hljs">@kwdef struct StorageInvData &lt;: InvestmentData
    charge::Union{AbstractInvData, Nothing} = nothing
    level::Union{AbstractInvData, Nothing} = nothing
    discharge::Union{AbstractInvData, Nothing} = nothing
end</code></pre><p>As outlined, <a href="../../library/public/#EnergyModelsInvestments.AbstractInvData"><code>AbstractInvData</code></a> has at the time being two subtypes, <a href="../../library/public/#EnergyModelsInvestments.NoStartInvData"><code>NoStartInvData</code></a> and <a href="../../library/public/#EnergyModelsInvestments.StartInvData"><code>StartInvData</code></a>. Depending on whether you specified in your previous <code>InvDataStorage</code> instance the field <code>rate_start</code> and <code>stor_start</code>, you will have to use either <a href="../../library/public/#EnergyModelsInvestments.NoStartInvData"><code>NoStartInvData</code></a> (not specified) or <a href="../../library/public/#EnergyModelsInvestments.StartInvData"><code>StartInvData</code></a> (specified).</p><p>In addition, if you used the <code>rate</code> variables previously for the charge or discharge rate, you have to adjust the investment data slightly. A <a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/library/public/#EnergyModelsBase.RefStorage"><code>RefStorage</code></a> node from <code>EnergyModelsBase</code> would be given then as:</p><pre><code class="language-julia hljs">StorageInvData(
    charge = NoStartInvData(
        capex = capex_rate,
        max_inst = rate_max_inst,
        inv_mode = inv_mode,
        life_mode = life_mode,
    ),
    level = NoStartInvData(
        capex = capex_stor,
        max_inst = stor_max_inst,
        inv_mode = inv_mode,
        life_mode = life_mode,
    ),
)</code></pre><p>while a node <a href="https://energymodelsx.github.io/EnergyModelsRenewableProducers.jl/stable/library/public/#EnergyModelsRenewableProducers.HydroStor"><code>HydroStor</code></a> from <code>EnergyModelsRenewableProducers</code>, in which the rate was used for the discharge, would be then given as:</p><pre><code class="language-julia hljs">StorageInvData(
    level = NoStartInvData(
        capex = capex_stor,
        max_inst = stor_max_inst,
        inv_mode = inv_mode,
        life_mode = life_mode,
    ),
    discharge = NoStartInvData(
        capex = capex_stor,
        max_inst = stor_max_inst,
        inv_mode = inv_mode,
        life_mode = life_mode,
    ),
)</code></pre><p>The translation of the parameters <code>rate_max_add</code>, <code>rate_min_add</code>, <code>rate_increment</code>, <code>stor_max_add</code>, <code>stor_min_add</code>,  <code>stor_increment</code> is dependent on the chosen investment mode, see below. This makes the legacy constructor slightly more complex as it is necessary to check for the individual type.</p><h3 id="how_to-update-05-inv_modes"><a class="docs-heading-anchor" href="#how_to-update-05-inv_modes">Investment modes</a><a id="how_to-update-05-inv_modes-1"></a><a class="docs-heading-anchor-permalink" href="#how_to-update-05-inv_modes" title="Permalink"></a></h3><p><em><a href="../../manual/philosophy/#man-phil-inv_mode">Investment modes</a></em> include now the required data. This implies that the direct translation is now dependent on the individual investment mode. Below, you can find the approach for <code>InvData</code> legacy constructors, although the approach is the same for <code>InvDataStorage</code> and <code>TransInvData</code>.</p><pre><code class="language-julia hljs"># DiscreteInvestment
inv_mode = DiscreteInvestment(cap_increment)

# ContinuousInvestment
inv_mode = ContinuousInvestment(cap_min_add, cap_max_add)

# SemiContinuousInvestment
inv_mode = SemiContinuousInvestment(cap_min_add, cap_max_add)

# SemiContinuousOffsetInvestment
inv_mode = SemiContinuousOffsetInvestment(trans_min_add, trans_max_add, capex_trans_offset)</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>We do not provide any constructors for <code>BinaryInvestment</code> and <code>FixedInvestment</code> as it is not possible to deduce the capacity directly from the provided constructor. Instead, the model will throw an error.</p></div></div><p><code>BinaryInvestment</code> and <code>FixedInvestment</code> can be solved using the following approach, outlined for a <code>Source</code> node:</p><pre><code class="language-julia hljs"># Consider the following Source node in which the investment_data_source used
# BinaryInvestment or FixedInvestment
source = RefSource(
    &quot;electricity source&quot;,       # Node ID
    StrategicProfile([10, 15]), # Capacity in MW
    FixedProfile(10),           # Variable OPEX in EUR/MW
    FixedProfile(5),            # Fixed OPEX in EUR/year
    Dict(Power =&gt; 1),           # Output from the Node, in this gase, Power
    [investment_data_source],   # Additional data used for adding the investment data
)

# The original investment data type was given as
investment_data_source = InvData(
    capex_cap = FixedProfile(300000),   # CAPEX [€/MW]
    cap_max_inst = FixedProfile(30),    # max installed capacity [MW]
    cap_max_add = FixedProfile(30),     # max added capactity per sp [MW]
    cap_min_add = FixedProfile(0),      # min added capactity per sp [MW]
    inv_mode = FixedInvestments(),      # investment mode
    cap_start = 0,                      # initial capacity
    life_mode = RollingLife(),          # Lifetime mode
    lifetime = FixedProfile(15),        # Lifetime
)

# The new investment data type is then given as
investment_data_source = SingleInvData(
    FixedProfile(300*1e3),          # CAPEX [€/MW]
    FixedProfile(30),               # max installed capacity [MW]
    FixedProfile(0),                # max installed capacity [MW]
    FixedInvestments(StrategicProfile([10, 15])),
    # Line above: Investment mode with the following arguments:
    # New capacity in the investment period, if invested in [MW]
    RollingLife(FixedProfile(15)),  # Lifetime mode
)</code></pre><h3 id="how_to-update-05-life_modes"><a class="docs-heading-anchor" href="#how_to-update-05-life_modes">Lifetime modes</a><a id="how_to-update-05-life_modes-1"></a><a class="docs-heading-anchor-permalink" href="#how_to-update-05-life_modes" title="Permalink"></a></h3><p><em><a href="../../manual/philosophy/#man-phil-life_mode">Lifetime modes</a></em> now include the required lifetime. Below, you can find the approach for <code>InvData</code> legacy constructors, although the approach is the same for <code>InvDataStorage</code> and <code>TransInvData</code>.</p><pre><code class="language-julia hljs"># StudyLife
life_mode = StudyLife(lifetime)

# StudyLife
life_mode = PeriodLife(lifetime)

# StudyLife
life_mode = RollingLife(lifetime)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../manual/NEWS/">« Release notes</a><a class="docs-footer-nextpage" href="../use-emi/">Use EMI »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 16 October 2024 09:05">Wednesday 16 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
